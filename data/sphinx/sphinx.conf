# This configuration generated by Skynar CMS
# Applicaation inventure
# Used models:
#       Core\Page
#       \Page\Content
#       Analytics\Page
#       Page\Page
#       Blog\Model
#       Blog\Blog
#       Blog\Post
#       Blog\Category
#       Blog\Rubric

source s_inventure
{
    type            = mysql
    sql_host        = 127.0.0.1
    sql_user        = inventure
    sql_pass        = 6Qq2fnX51zShHhDO
    sql_db          = inventure_prod
    sql_port        = 3306
    sql_query_pre   = SET NAMES utf8
    sql_query       = SELECT t1.id as id, t1.h1 as h1, UNIX_TIMESTAMP(t1.published) as published, t1.short_text as short_text, t1.attr as attr, GROUP_CONCAT(t2.text SEPARATOR ' ') as text, t1.route_id as route, t1.parent_id as parent, t3.views as views, t3.rating as rating, t1.class as t1_class FROM Page as t1 LEFT JOIN PagePart as t2 ON t2.page_id = t1.id LEFT JOIN Analytics_Page as t3 ON t3.page_id = t1.id WHERE t1.status=1 AND t1.deleted=0 AND t2.type LIKE '13' GROUP BY t1.id
    sql_attr_multi =  uint categories from query; SELECT post_id, page_id FROM post_page 
    sql_attr_multi =  uint rubrics from query; SELECT post_id, rubric_id FROM post_rubric 
    sql_attr_timestamp = published 
    sql_attr_json = attr 
    sql_attr_uint = route 
    sql_attr_uint = parent 
    sql_attr_uint = views 
    sql_attr_float = rating 
    sql_attr_uint = t1_class 

    sql_ranged_throttle    = 0

}

index full_inventure
{
    source            = s_inventure
    path              = /var/lib/sphinxsearch/index/inventure
    docinfo           = extern
    dict              = keywords
    mlock             = 0
    morphology        = stem_en, stem_ru, soundex
    embedded_limit    = 16K
    min_word_len      = 1
    html_strip        = 1

}

index inventure
{
        type            = distributed
        local           = full_inventure
#        local           = delta_inventure
}
