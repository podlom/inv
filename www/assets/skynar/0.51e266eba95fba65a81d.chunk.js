(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"./src/Skynar/EntitySelect.tsx":
/*!*************************************!*\
  !*** ./src/Skynar/EntitySelect.tsx ***!
  \*************************************/
/*! exports provided: default */function(e,t,n){"use strict";n.r(t);var s=n(/*! tslib */"./node_modules/tslib/tslib.es6.js"),i=n(/*! react */"react"),a=n(/*! react-virtualized-select */"./node_modules/react-virtualized-select/dist/commonjs/index.js"),o=n.n(a),r=(n(/*! react-select/dist/react-select.css */"./node_modules/react-select/dist/react-select.css"),n(/*! react-virtualized/styles.css */"./node_modules/react-virtualized/styles.css"),n(/*! react-virtualized-select/styles.css */"./node_modules/react-virtualized-select/styles.css"),function(e){function t(t){var n=e.call(this,t)||this;n.loadOptions=n.loadOptions.bind(n);var s=t.multiple?t.value instanceof Array?t.value:[]:"string"==typeof t.value||"number"==typeof t.value?t.value:"";return n.state={value:s},n}return s.__extends(t,e),t.prototype.loadOptions=function(e,t){return fetch(this.props.url+".mjson?count="+(this.props.count||100)+"&q="+e,{credentials:"include"}).then(function(e){return e.json()}).then(function(e){return{options:e.items,complete:e.total<=e.count}})},t.prototype.onSelect=function(e){var t=null!=e?Array.isArray(e)?e.map(function(e){return e.eid}):e.eid:"";this.setState({value:t}),"function"==typeof this.props.onChange&&this.props.onChange(t)},t.prototype.none=function(){},t.prototype.renderOption=function(e){var t=e.focusedOption,n=e.focusOption,a=e.key,o=(e.labelKey,e.option),r=e.selectValue,l=e.style,c=e.valueArray,p=["es_option"];o===t&&p.push("es_focus"),o.disabled&&p.push("es_disabled"),c&&c.indexOf(o)>=0&&p.push("es_selected"),o.className&&p.push(o.className);var u=o.disabled?{}:{onClick:function(){return r(o)},onMouseEnter:function(){return n(o)}},d=!1;return"string"==typeof o.image&&(d=o.image,p.push("es_has_img"),"/"==o.image.substr(0,1)&&"/"!=o.image.substr(1,1)&&(d="/img/thumb.64"+o.image)),i.createElement("div",s.__assign({className:p.join(" "),key:a,style:l,title:o.title},u),i.createElement("div",{className:"es_wrap"},d&&i.createElement("img",{src:d,className:"es_img",key:"img"}),i.createElement("div",{className:"es_title",key:"ttl"},o.title),i.createElement("div",{className:"es_description",key:"dsc"},o.description)))},t.prototype.render=function(){var e=this.state.value instanceof Array?JSON.stringify(this.state.value):this.state.value;return i.createElement("div",{className:"sri-node"},i.createElement(o.a,{async:!0,loadOptions:this.loadOptions,onChange:this.onSelect.bind(this),labelKey:"title",valueKey:"eid",value:this.state.value,multi:this.props.multiple,optionRenderer:this.renderOption,optionHeight:function(e){var t=e.option;return"string"==typeof t.description||"string"==typeof t.image?64:35},palceholder:this.props.placeholder}),i.createElement("input",{type:"hidden",key:"input",name:this.props.name,onChange:this.none,value:e}))},t.defaultProps={multiple:!1,value:""},t}(i.Component));t.default=r},"./src/Template/TplConfig.tsx":
/*!************************************!*\
  !*** ./src/Template/TplConfig.tsx ***!
  \************************************/
/*! exports provided: TplConfig */function(e,t,n){"use strict";n.r(t),n.d(t,"TplConfig",function(){return r});var s=n(/*! tslib */"./node_modules/tslib/tslib.es6.js"),i=n(/*! react */"react"),a=n(/*! ../Skynar/EntitySelect */"./src/Skynar/EntitySelect.tsx"),o=new Headers;o.set("Content-Type","text/json;charset=UTF-8");var r=function(e){function t(t){var n=e.call(this,t)||this;return n.state={active:0,config:n.props.config?Object.assign({},n.props.config):null},n.save=n.save.bind(n),n}return s.__extends(t,e),t.prototype.onChange=function(e){console.log(e)},t.prototype.updateItem=function(e,t){var n=Object.assign({},this.state.config);n[e]=t,this.setState({config:n})},t.prototype.input=function(e,t,n){void 0===n&&(n="text");var s=this.state.config&&"string"==typeof this.state.config[e],a=s?this.state.config[e]:"Disabled";return i.createElement(c,{key:e,active:s,value:a,label:t,type:n,onChange:this.updateItem.bind(this,e)})},t.prototype.list=function(e,t,n){void 0===n&&(n="text");var s=this.state.config&&"object"==typeof this.state.config[e],a=s?this.state.config[e]:"Disabled";return i.createElement(l,{key:e,active:s,value:a,label:t,type:n,onChange:this.updateItem.bind(this,e)})},t.prototype.save=function(e){e.preventDefault();var t=e.currentTarget;t.disabled=!0,t.innerHTML='\n\t\t\t<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>\n\t\t\tСохраняю...\n\t\t\t',fetch(location.pathname+".json",{headers:o,method:"POST",body:JSON.stringify(this.state.config),credentials:"include"}).then(function(e){200==e.status?(t.innerHTML='\n\t\t\t\t\t<i class="fa fa-check" aria-hidden="true"></i> Сохранено\n\t\t\t\t',setTimeout(function(){t.disabled=!1,t.innerHTML='\n\t\t\t\t\t\t<i class="fa fa-floppy-o" aria-hidden="true"></i> Сохранить настройки\n\t\t\t\t\t'},3e3)):t.innerHTML="\n\t\t\t\t\tПри сохранении возникла ошибка!\n\t\t\t\t"})},t.prototype.render=function(){return i.createElement("div",{className:"tpl_config"},this.input("subject","Тема письма"),i.createElement("div",{className:"form-group"},i.createElement("label",null,"Сервер для рассылки"),i.createElement(a.default,{onChange:this.updateItem.bind(this,"from"),value:this.state.config.from,multiple:!1,name:"from",url:this.props.url})),this.input("from_name","От кого"),this.list("to","TO"),this.list("cc","CC"),this.list("bcc","BCC"),i.createElement("div",{className:"form-group text-right"},i.createElement("button",{className:"btn btn-main save-settings",onClick:this.save},i.createElement("i",{className:"fa fa-floppy-o","aria-hidden":"true"})," Сохранить настройки")))},t}(i.Component),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={emails:Object.keys(n.props.value).map(function(e){return[e,n.props.value[e]]})},n.add=n.add.bind(n),n.upd=n.upd.bind(n),n}return s.__extends(t,e),t.prototype.upd=function(){this.props.onChange(this.state.emails.reduce(function(e,t){return e[t[0]]=t[1],e},{}))},t.prototype.update=function(e,t,n){var s=this.state.emails.slice();s[e][t]=n,this.setState({emails:s},this.upd)},t.prototype.add=function(e){e.preventDefault();var t=this.state.emails.slice();t.push(["",""]),this.setState({emails:t},this.upd)},t.prototype.remove=function(e,t){t.preventDefault();var n=this.state.emails.slice();n.splice(e,1),this.setState({emails:n},this.upd)},t.prototype.render=function(){var e=this;return this.props.active&&i.createElement("fieldset",{className:this.props.active?"":"disabled"},i.createElement("p",null,this.props.label),i.createElement("div",null,console.log(this.state.emails),this.props.active&&this.state.emails.map(function(t,n){return i.createElement("span",{key:n},i.createElement(c,{active:!0,label:"Name",value:t[1],onChange:e.update.bind(e,n,1)}),i.createElement(c,{active:!0,label:"Email",value:t[0],onChange:e.update.bind(e,n,0),type:"email"}),i.createElement("button",{className:"remove",onClick:e.remove.bind(e,n)},i.createElement("i",{className:"fi fi-delete"})))}),this.props.active&&i.createElement("button",{className:"add",key:"b",onClick:this.add},"+")))},t}(i.Component),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange(e.target.value)},t.prototype.onblur=function(e){e.target.value},t.prototype.render=function(){return i.createElement("div",{className:"form-group"},i.createElement("span",{className:this.props.active?"input":"disabled input"},i.createElement("label",null,this.props.label),i.createElement("input",{value:this.props.value,className:"form-control",onBlur:this.onblur.bind(this),placeholder:this.props.label,onChange:this.onChange.bind(this),type:this.props.type||"text",disabled:!this.props.active})))},t}(i.Component)}}]);