(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./src/Mail/Mailer.tsx":function(t,e,s){"use strict";s.r(e);var a=s("./node_modules/tslib/tslib.es6.js"),i=s("react"),n=function(t){function e(e){var s=t.call(this,e)||this;return s.state={active:!1,delay:5,stats:e.stats.map(function(t){return parseInt(t)})},s.start=s.start.bind(s),s.stop=s.stop.bind(s),s.tick=s.tick.bind(s),s.fetch=s.fetch.bind(s),s.changeDelay=s.changeDelay.bind(s),s}return a.b(e,t),e.prototype.render=function(){var t=this.state.stats[0]+this.state.stats[1]+this.state.stats[2],e=this.state.stats[1]/t*100+"%",s=this.state.stats[2]/t*100+"%";return console.log(t,this.state.stats[1]/t*100,this.state.stats[1]/t*100+"%"),i.createElement("div",{className:"mailer"},i.createElement("h3",null,"Mailing status: ",i.createElement("span",{className:"queue"},this.state.stats[0]),"/",i.createElement("span",{className:"done"},this.state.stats[1]),"/",i.createElement("span",{className:"fail"},this.state.stats[2])),i.createElement("div",{className:"progress"},i.createElement("div",{className:"done",style:{flex:"0 0 "+e}}),i.createElement("div",{className:"fail",style:{width:"0 0 "+s}}),i.createElement("div",{className:"other"})),i.createElement("label",null,"Send delay (sec): ",i.createElement("input",{type:"number",value:this.state.delay,onChange:this.changeDelay})),i.createElement("button",{className:"button green",disabled:this.state.active,onClick:this.start},"Start"),i.createElement("button",{className:"button red",disabled:!this.state.active,onClick:this.stop},"Stop"))},e.prototype.changeDelay=function(t){this.setState({delay:t.target.value})},e.prototype.start=function(){this.setState({active:!0},this.tick)},e.prototype.stop=function(){this.setState({active:!1}),clearTimeout(this.timer),this.timer=null},e.prototype.tick=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(this.fetch,1e3*this.state.delay)},e.prototype.fetch=function(){var t=this;fetch(this.props.url+".json",{credentials:"include"}).then(function(t){return t.json()}).then(function(e){e.stats?(t.setState({stats:e.stats.map(function(t){return parseInt(t)})}),t.state.active&&t.tick()):t.setState({active:!1})})},e}(i.Component);e.default=n}}]);